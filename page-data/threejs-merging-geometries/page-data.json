{"componentChunkName":"component---src-templates-blog-post-js","path":"/threejs-merging-geometries/","webpackCompilationHash":"adc5a099dfbc8e80d26d","result":{"data":{"site":{"siteMetadata":{"title":"Jeremy Abroad","author":"Jeremy Bernier"}},"markdownRemark":{"id":"61b25c5e-7c68-5bbf-9ff4-c58e200a48a4","excerpt":"Merging multiple small geometries into one single geometry is generally more performant. Rendering 150,000 cubes would be excruciatingly…","html":"<p>Merging multiple small geometries into one single geometry is generally more performant. <a href=\"http://alteredqualia.com/three/examples/webgl_cubes.html\">Rendering 150,000 cubes</a> would be excruciatingly slow if each geometry were rendered separately.</p>\n<p>In Three.js, the THREE.Geometry class has a merge() function that allows you to merge two geometries. Below is a function that will take in an array of meshes and return a THREE.Geometry object with the geometries combined:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function mergeMeshes (meshes) {\n  var combined = new THREE.Geometry();\n\n  for (var i = 0; i &lt; meshes.length; i++) {\n    meshes[i].updateMatrix();\n    combined.merge(meshes[i].geometry, meshes[i].matrix);\n  }\n\n  return combined;\n}</code></pre></div>\n<p>Here’s an example of the function in action:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">var meshes = [], geometry, material, mesh;\n\ngeometry = new THREE.BoxGeometry(50,50,50);\nmaterial = new THREE.MeshLambertMaterial({color: 0xCC0000});\nmesh = new THREE.Mesh(geometry, material);\nmeshes.push(mesh);\n\nmesh = new THREE.Mesh(geometry, material);\nmesh.position.x = 100;\nmeshes.push(mesh);\n\n//merge both geometries\ngeometry = mergeMeshes(meshes);\nmesh = new THREE.Mesh(geometry, material);\nscene.add(mesh);</code></pre></div>\n<p>For this to work, the geometries you combine have to be regular geometries and not BufferGeometries. </p>\n<p>Unfortunately if you merge a bunch of adjacent cubes, the faces they share will still exist. So if you merge 3x3x3 cubes, it’s going to look like one big box on the outside, but on the inside you’re still going to see all those little individual cubes. It is possible to remove them, but as far as I know you have to remove each face individually. </p>\n<p>Anyways I only wrote this because all the info on Google seems to be outdated (THREE.GeometryUtils.merge has been deprecated)</p>","frontmatter":{"title":"Merging Geometries in Three.js","date":"June 29, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/threejs-merging-geometries/","previous":{"fields":{"slug":"/making-a-game/"},"frontmatter":{"title":"Making a 3D Game","tags":["tech"]}},"next":{"fields":{"slug":"/weekend-in-soul-and-tokyo/"},"frontmatter":{"title":"A Weekend in Seoul and Tokyo","tags":["travel"]}}}}}